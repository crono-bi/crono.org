<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sentencias MERGE ❤️ | Manual de usuario</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Manual de Usuario Crono">
    <meta name="theme-color" content="#007bcc">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.e7427e48.css" as="style"><link rel="preload" href="/assets/js/app.10bbc7f8.js" as="script"><link rel="preload" href="/assets/js/2.b4361566.js" as="script"><link rel="preload" href="/assets/js/322.21684d99.js" as="script"><link rel="prefetch" href="/assets/js/10.7ad09a68.js"><link rel="prefetch" href="/assets/js/100.9f075927.js"><link rel="prefetch" href="/assets/js/101.913c77ab.js"><link rel="prefetch" href="/assets/js/102.e70f39eb.js"><link rel="prefetch" href="/assets/js/103.3d2cbfec.js"><link rel="prefetch" href="/assets/js/104.77331634.js"><link rel="prefetch" href="/assets/js/105.5a2fab78.js"><link rel="prefetch" href="/assets/js/106.1683848d.js"><link rel="prefetch" href="/assets/js/107.e9c594c6.js"><link rel="prefetch" href="/assets/js/108.f1555186.js"><link rel="prefetch" href="/assets/js/109.9d374005.js"><link rel="prefetch" href="/assets/js/11.2a053600.js"><link rel="prefetch" href="/assets/js/110.45bc482b.js"><link rel="prefetch" href="/assets/js/111.d7009ddf.js"><link rel="prefetch" href="/assets/js/112.d91d7be4.js"><link rel="prefetch" href="/assets/js/113.8a7b8304.js"><link rel="prefetch" href="/assets/js/114.7f505bfd.js"><link rel="prefetch" href="/assets/js/115.4f300d8b.js"><link rel="prefetch" href="/assets/js/116.013bac5d.js"><link rel="prefetch" href="/assets/js/117.68dcc8e3.js"><link rel="prefetch" href="/assets/js/118.d2766d12.js"><link rel="prefetch" href="/assets/js/119.05bc8ec9.js"><link rel="prefetch" href="/assets/js/12.bdb1a61c.js"><link rel="prefetch" href="/assets/js/120.17107952.js"><link rel="prefetch" href="/assets/js/121.c0dc5328.js"><link rel="prefetch" href="/assets/js/122.d175e22f.js"><link rel="prefetch" href="/assets/js/123.9121c64c.js"><link rel="prefetch" href="/assets/js/124.ee9fa263.js"><link rel="prefetch" href="/assets/js/125.6933f599.js"><link rel="prefetch" href="/assets/js/126.6701c2cd.js"><link rel="prefetch" href="/assets/js/127.d19b3755.js"><link rel="prefetch" href="/assets/js/128.4f165824.js"><link rel="prefetch" href="/assets/js/129.a9d2dfd3.js"><link rel="prefetch" href="/assets/js/13.7194a6a4.js"><link rel="prefetch" href="/assets/js/130.5d934a26.js"><link rel="prefetch" href="/assets/js/131.79739c29.js"><link rel="prefetch" href="/assets/js/132.5acf1803.js"><link rel="prefetch" href="/assets/js/133.54f79adb.js"><link rel="prefetch" href="/assets/js/134.cea6eec4.js"><link rel="prefetch" href="/assets/js/135.8dd3e054.js"><link rel="prefetch" href="/assets/js/136.ea3dd8f2.js"><link rel="prefetch" href="/assets/js/137.0b7e0f24.js"><link rel="prefetch" href="/assets/js/138.b100d865.js"><link rel="prefetch" href="/assets/js/139.762328e5.js"><link rel="prefetch" href="/assets/js/14.18f954cb.js"><link rel="prefetch" href="/assets/js/140.dcb32e6d.js"><link rel="prefetch" href="/assets/js/141.76665b01.js"><link rel="prefetch" href="/assets/js/142.4cd90c9f.js"><link rel="prefetch" href="/assets/js/143.a4ec62d9.js"><link rel="prefetch" href="/assets/js/144.a1fd7457.js"><link rel="prefetch" href="/assets/js/145.178bf244.js"><link rel="prefetch" href="/assets/js/146.0eede631.js"><link rel="prefetch" href="/assets/js/147.a50b6880.js"><link rel="prefetch" href="/assets/js/148.49895c26.js"><link rel="prefetch" href="/assets/js/149.ebb61971.js"><link rel="prefetch" href="/assets/js/15.3b4bcbea.js"><link rel="prefetch" href="/assets/js/150.83693223.js"><link rel="prefetch" href="/assets/js/151.54d99026.js"><link rel="prefetch" href="/assets/js/152.f03b21fb.js"><link rel="prefetch" href="/assets/js/153.5ea15e21.js"><link rel="prefetch" href="/assets/js/154.1b40f8cc.js"><link rel="prefetch" href="/assets/js/155.5c7fecef.js"><link rel="prefetch" href="/assets/js/156.7bd83850.js"><link rel="prefetch" href="/assets/js/157.83f6b761.js"><link rel="prefetch" href="/assets/js/158.5ede26b9.js"><link rel="prefetch" href="/assets/js/159.d9f7b8d0.js"><link rel="prefetch" href="/assets/js/16.5900e359.js"><link rel="prefetch" href="/assets/js/160.b25a821e.js"><link rel="prefetch" href="/assets/js/161.9c00bb1b.js"><link rel="prefetch" href="/assets/js/162.b23bfe71.js"><link rel="prefetch" href="/assets/js/163.77be0e91.js"><link rel="prefetch" href="/assets/js/164.dea555be.js"><link rel="prefetch" href="/assets/js/165.edd9e4ae.js"><link rel="prefetch" href="/assets/js/166.f5297ad6.js"><link rel="prefetch" href="/assets/js/167.5ab7c5a7.js"><link rel="prefetch" href="/assets/js/168.ce24710a.js"><link rel="prefetch" href="/assets/js/169.3145ef76.js"><link rel="prefetch" href="/assets/js/17.b18a2ddc.js"><link rel="prefetch" href="/assets/js/170.90545f3c.js"><link rel="prefetch" href="/assets/js/171.fbc7377c.js"><link rel="prefetch" href="/assets/js/172.ee35c8f4.js"><link rel="prefetch" href="/assets/js/173.9bd2c118.js"><link rel="prefetch" href="/assets/js/174.39551783.js"><link rel="prefetch" href="/assets/js/175.5361d7bc.js"><link rel="prefetch" href="/assets/js/176.a6cb6df6.js"><link rel="prefetch" href="/assets/js/177.ca925d12.js"><link rel="prefetch" href="/assets/js/178.5f929df5.js"><link rel="prefetch" href="/assets/js/179.53326cd2.js"><link rel="prefetch" href="/assets/js/18.1b2a06d4.js"><link rel="prefetch" href="/assets/js/180.fa652531.js"><link rel="prefetch" href="/assets/js/181.a365bfcf.js"><link rel="prefetch" href="/assets/js/182.8d375ebf.js"><link rel="prefetch" href="/assets/js/183.0afe90ef.js"><link rel="prefetch" href="/assets/js/184.f85e5337.js"><link rel="prefetch" href="/assets/js/185.9dde165d.js"><link rel="prefetch" href="/assets/js/186.0dfc7120.js"><link rel="prefetch" href="/assets/js/187.7a1be0f3.js"><link rel="prefetch" href="/assets/js/188.dddfafe4.js"><link rel="prefetch" href="/assets/js/189.0d6c89df.js"><link rel="prefetch" href="/assets/js/19.d5cf31da.js"><link rel="prefetch" href="/assets/js/190.ec5b9d41.js"><link rel="prefetch" href="/assets/js/191.8a7f7f89.js"><link rel="prefetch" href="/assets/js/192.5175a33a.js"><link rel="prefetch" href="/assets/js/193.e38d99d1.js"><link rel="prefetch" href="/assets/js/194.2df2180f.js"><link rel="prefetch" href="/assets/js/195.d7a2d589.js"><link rel="prefetch" href="/assets/js/196.be08384d.js"><link rel="prefetch" href="/assets/js/197.ac9f326e.js"><link rel="prefetch" href="/assets/js/198.3588f57b.js"><link rel="prefetch" href="/assets/js/199.cfd99147.js"><link rel="prefetch" href="/assets/js/20.5cd6a292.js"><link rel="prefetch" href="/assets/js/200.b42bb912.js"><link rel="prefetch" href="/assets/js/201.798cf751.js"><link rel="prefetch" href="/assets/js/202.dd73c03a.js"><link rel="prefetch" href="/assets/js/203.a6a8f08a.js"><link rel="prefetch" href="/assets/js/204.b4fb4936.js"><link rel="prefetch" href="/assets/js/205.5f67eae0.js"><link rel="prefetch" href="/assets/js/206.a212f35b.js"><link rel="prefetch" href="/assets/js/207.cb2712af.js"><link rel="prefetch" href="/assets/js/208.8a90bff2.js"><link rel="prefetch" href="/assets/js/209.ff79873f.js"><link rel="prefetch" href="/assets/js/21.9036b73d.js"><link rel="prefetch" href="/assets/js/210.77478498.js"><link rel="prefetch" href="/assets/js/211.4c04b8d7.js"><link rel="prefetch" href="/assets/js/212.70ff7ec1.js"><link rel="prefetch" href="/assets/js/213.e9359944.js"><link rel="prefetch" href="/assets/js/214.874c8b63.js"><link rel="prefetch" href="/assets/js/215.a5dca774.js"><link rel="prefetch" href="/assets/js/216.04f73341.js"><link rel="prefetch" href="/assets/js/217.f0d427cd.js"><link rel="prefetch" href="/assets/js/218.afcdd126.js"><link rel="prefetch" href="/assets/js/219.ee8ed8dc.js"><link rel="prefetch" href="/assets/js/22.afdadde4.js"><link rel="prefetch" href="/assets/js/220.8374ad13.js"><link rel="prefetch" href="/assets/js/221.3c726b88.js"><link rel="prefetch" href="/assets/js/222.d65da099.js"><link rel="prefetch" href="/assets/js/223.ac181b03.js"><link rel="prefetch" href="/assets/js/224.447b9468.js"><link rel="prefetch" href="/assets/js/225.ab71c635.js"><link rel="prefetch" href="/assets/js/226.e78b8ca4.js"><link rel="prefetch" href="/assets/js/227.42b01eae.js"><link rel="prefetch" href="/assets/js/228.66ca4ac0.js"><link rel="prefetch" href="/assets/js/229.e14bf5e1.js"><link rel="prefetch" href="/assets/js/23.daad4f1a.js"><link rel="prefetch" href="/assets/js/230.e2be774e.js"><link rel="prefetch" href="/assets/js/231.bd89c5cf.js"><link rel="prefetch" href="/assets/js/232.e3a20f33.js"><link rel="prefetch" href="/assets/js/233.a44537ea.js"><link rel="prefetch" href="/assets/js/234.70ce5639.js"><link rel="prefetch" href="/assets/js/235.5b2361e8.js"><link rel="prefetch" href="/assets/js/236.95202abd.js"><link rel="prefetch" href="/assets/js/237.fdebc83e.js"><link rel="prefetch" href="/assets/js/238.0c3430d1.js"><link rel="prefetch" href="/assets/js/239.ef801570.js"><link rel="prefetch" href="/assets/js/24.f4878249.js"><link rel="prefetch" href="/assets/js/240.79173cf8.js"><link rel="prefetch" href="/assets/js/241.c0f25b7d.js"><link rel="prefetch" href="/assets/js/242.ffb2aba8.js"><link rel="prefetch" href="/assets/js/243.a9050867.js"><link rel="prefetch" href="/assets/js/244.3e931fe7.js"><link rel="prefetch" href="/assets/js/245.7d0692bd.js"><link rel="prefetch" href="/assets/js/246.aec40777.js"><link rel="prefetch" href="/assets/js/247.cc1ad493.js"><link rel="prefetch" href="/assets/js/248.bcc55440.js"><link rel="prefetch" href="/assets/js/249.0a218ac8.js"><link rel="prefetch" href="/assets/js/25.65ffacde.js"><link rel="prefetch" href="/assets/js/250.f13bf8ba.js"><link rel="prefetch" href="/assets/js/251.c9339579.js"><link rel="prefetch" href="/assets/js/252.0109ae14.js"><link rel="prefetch" href="/assets/js/253.e8aec3cc.js"><link rel="prefetch" href="/assets/js/254.95a7344b.js"><link rel="prefetch" href="/assets/js/255.043c9b50.js"><link rel="prefetch" href="/assets/js/256.1da7758b.js"><link rel="prefetch" href="/assets/js/257.58f79596.js"><link rel="prefetch" href="/assets/js/258.6d3bd136.js"><link rel="prefetch" href="/assets/js/259.0e2c3dcf.js"><link rel="prefetch" href="/assets/js/26.d236474e.js"><link rel="prefetch" href="/assets/js/260.24266cfa.js"><link rel="prefetch" href="/assets/js/261.1d40147e.js"><link rel="prefetch" href="/assets/js/262.1c3a2ead.js"><link rel="prefetch" href="/assets/js/263.3b7a8fc6.js"><link rel="prefetch" href="/assets/js/264.c981b102.js"><link rel="prefetch" href="/assets/js/265.fda297ca.js"><link rel="prefetch" href="/assets/js/266.63e709d4.js"><link rel="prefetch" href="/assets/js/267.d534dbaa.js"><link rel="prefetch" href="/assets/js/268.6aec96dc.js"><link rel="prefetch" href="/assets/js/269.c4dfb107.js"><link rel="prefetch" href="/assets/js/27.640d67bb.js"><link rel="prefetch" href="/assets/js/270.2594f526.js"><link rel="prefetch" href="/assets/js/271.db4c790e.js"><link rel="prefetch" href="/assets/js/272.8df29695.js"><link rel="prefetch" href="/assets/js/273.34f53cc8.js"><link rel="prefetch" href="/assets/js/274.dcb5b9b3.js"><link rel="prefetch" href="/assets/js/275.0077f990.js"><link rel="prefetch" href="/assets/js/276.a1078e15.js"><link rel="prefetch" href="/assets/js/277.13675cd2.js"><link rel="prefetch" href="/assets/js/278.bdd5c8e6.js"><link rel="prefetch" href="/assets/js/279.6e35548f.js"><link rel="prefetch" href="/assets/js/28.ce9afa31.js"><link rel="prefetch" href="/assets/js/280.232b18ac.js"><link rel="prefetch" href="/assets/js/281.263628b0.js"><link rel="prefetch" href="/assets/js/282.2a5eac3f.js"><link rel="prefetch" href="/assets/js/283.aa2e7ec6.js"><link rel="prefetch" href="/assets/js/284.0603bdbc.js"><link rel="prefetch" href="/assets/js/285.ee55d0a4.js"><link rel="prefetch" href="/assets/js/286.c04c3bce.js"><link rel="prefetch" href="/assets/js/287.8bbb7717.js"><link rel="prefetch" href="/assets/js/288.39c8ede7.js"><link rel="prefetch" href="/assets/js/289.087bb5bf.js"><link rel="prefetch" href="/assets/js/29.666e0523.js"><link rel="prefetch" href="/assets/js/290.e98b8b89.js"><link rel="prefetch" href="/assets/js/291.50ab2a02.js"><link rel="prefetch" href="/assets/js/292.e0183225.js"><link rel="prefetch" href="/assets/js/293.e6958463.js"><link rel="prefetch" href="/assets/js/294.3a884580.js"><link rel="prefetch" href="/assets/js/295.3a53639b.js"><link rel="prefetch" href="/assets/js/296.2f75dd5a.js"><link rel="prefetch" href="/assets/js/297.e04f337a.js"><link rel="prefetch" href="/assets/js/298.d2c9329f.js"><link rel="prefetch" href="/assets/js/299.ed117e2f.js"><link rel="prefetch" href="/assets/js/3.d6936096.js"><link rel="prefetch" href="/assets/js/30.269cf6da.js"><link rel="prefetch" href="/assets/js/300.3271b4b3.js"><link rel="prefetch" href="/assets/js/301.194ac2ed.js"><link rel="prefetch" href="/assets/js/302.9ea2642c.js"><link rel="prefetch" href="/assets/js/303.a2f6b4d7.js"><link rel="prefetch" href="/assets/js/304.7a447d5e.js"><link rel="prefetch" href="/assets/js/305.355ca4a6.js"><link rel="prefetch" href="/assets/js/306.e1ea52b4.js"><link rel="prefetch" href="/assets/js/307.fa735cb1.js"><link rel="prefetch" href="/assets/js/308.56354221.js"><link rel="prefetch" href="/assets/js/309.51cd43a3.js"><link rel="prefetch" href="/assets/js/31.ca8c6f37.js"><link rel="prefetch" href="/assets/js/310.e22f5077.js"><link rel="prefetch" href="/assets/js/311.76be7471.js"><link rel="prefetch" href="/assets/js/312.9d433317.js"><link rel="prefetch" href="/assets/js/313.44329734.js"><link rel="prefetch" href="/assets/js/314.d3cbae5f.js"><link rel="prefetch" href="/assets/js/315.1532bb46.js"><link rel="prefetch" href="/assets/js/316.46c92d7f.js"><link rel="prefetch" href="/assets/js/317.c3596c6f.js"><link rel="prefetch" href="/assets/js/318.3c73c890.js"><link rel="prefetch" href="/assets/js/319.1201f2e2.js"><link rel="prefetch" href="/assets/js/32.4e97da1f.js"><link rel="prefetch" href="/assets/js/320.b1e6a982.js"><link rel="prefetch" href="/assets/js/321.5a278f08.js"><link rel="prefetch" href="/assets/js/323.42aa8308.js"><link rel="prefetch" href="/assets/js/324.ac42e0a2.js"><link rel="prefetch" href="/assets/js/325.06b8bfec.js"><link rel="prefetch" href="/assets/js/326.cd137c14.js"><link rel="prefetch" href="/assets/js/327.485776ab.js"><link rel="prefetch" href="/assets/js/328.5b4cb4e7.js"><link rel="prefetch" href="/assets/js/329.1b5b4947.js"><link rel="prefetch" href="/assets/js/33.4c9254e2.js"><link rel="prefetch" href="/assets/js/330.b7c91c91.js"><link rel="prefetch" href="/assets/js/331.a32e0e3b.js"><link rel="prefetch" href="/assets/js/332.d7ae6be6.js"><link rel="prefetch" href="/assets/js/333.61c72d65.js"><link rel="prefetch" href="/assets/js/334.c15d9aa7.js"><link rel="prefetch" href="/assets/js/335.94236562.js"><link rel="prefetch" href="/assets/js/336.292fcf63.js"><link rel="prefetch" href="/assets/js/337.6de89f92.js"><link rel="prefetch" href="/assets/js/338.f07a22ba.js"><link rel="prefetch" href="/assets/js/339.bc6ed1ef.js"><link rel="prefetch" href="/assets/js/34.34f3c04c.js"><link rel="prefetch" href="/assets/js/340.c5604c9f.js"><link rel="prefetch" href="/assets/js/341.94d443f7.js"><link rel="prefetch" href="/assets/js/342.75da3586.js"><link rel="prefetch" href="/assets/js/343.1003702f.js"><link rel="prefetch" href="/assets/js/344.2c1cbb04.js"><link rel="prefetch" href="/assets/js/345.a74ee42a.js"><link rel="prefetch" href="/assets/js/346.5f3f7fc3.js"><link rel="prefetch" href="/assets/js/347.6a06de8b.js"><link rel="prefetch" href="/assets/js/348.a3d60d5a.js"><link rel="prefetch" href="/assets/js/349.5b260651.js"><link rel="prefetch" href="/assets/js/35.39b9b498.js"><link rel="prefetch" href="/assets/js/350.f777fa32.js"><link rel="prefetch" href="/assets/js/351.6f47581d.js"><link rel="prefetch" href="/assets/js/352.2e27d839.js"><link rel="prefetch" href="/assets/js/353.09bcfb8b.js"><link rel="prefetch" href="/assets/js/354.63569814.js"><link rel="prefetch" href="/assets/js/355.98347764.js"><link rel="prefetch" href="/assets/js/356.64e1f357.js"><link rel="prefetch" href="/assets/js/357.bd60ef78.js"><link rel="prefetch" href="/assets/js/358.cb958c52.js"><link rel="prefetch" href="/assets/js/359.63d72473.js"><link rel="prefetch" href="/assets/js/36.884012cf.js"><link rel="prefetch" href="/assets/js/360.5b687f66.js"><link rel="prefetch" href="/assets/js/361.50ee6b95.js"><link rel="prefetch" href="/assets/js/362.2d292329.js"><link rel="prefetch" href="/assets/js/363.777c2b5d.js"><link rel="prefetch" href="/assets/js/364.90ee8572.js"><link rel="prefetch" href="/assets/js/365.d32019b0.js"><link rel="prefetch" href="/assets/js/366.98f4582f.js"><link rel="prefetch" href="/assets/js/367.11dc5a6d.js"><link rel="prefetch" href="/assets/js/368.b0271294.js"><link rel="prefetch" href="/assets/js/369.a08e033a.js"><link rel="prefetch" href="/assets/js/37.e5a9040e.js"><link rel="prefetch" href="/assets/js/370.e050d55f.js"><link rel="prefetch" href="/assets/js/371.f735bb4a.js"><link rel="prefetch" href="/assets/js/372.cc89700d.js"><link rel="prefetch" href="/assets/js/373.91019bcb.js"><link rel="prefetch" href="/assets/js/374.66f8406a.js"><link rel="prefetch" href="/assets/js/375.47b89a8b.js"><link rel="prefetch" href="/assets/js/376.4f5aab94.js"><link rel="prefetch" href="/assets/js/377.89b48d6a.js"><link rel="prefetch" href="/assets/js/378.8ab17a6d.js"><link rel="prefetch" href="/assets/js/379.73f05bc9.js"><link rel="prefetch" href="/assets/js/38.5a26c0ce.js"><link rel="prefetch" href="/assets/js/380.9c57977f.js"><link rel="prefetch" href="/assets/js/381.44f8d7ea.js"><link rel="prefetch" href="/assets/js/382.3b7468b5.js"><link rel="prefetch" href="/assets/js/39.94730e16.js"><link rel="prefetch" href="/assets/js/4.6d90be92.js"><link rel="prefetch" href="/assets/js/40.c2b50a48.js"><link rel="prefetch" href="/assets/js/41.e03687e9.js"><link rel="prefetch" href="/assets/js/42.f2a7f4a4.js"><link rel="prefetch" href="/assets/js/43.6cf295d1.js"><link rel="prefetch" href="/assets/js/44.5eea10f5.js"><link rel="prefetch" href="/assets/js/45.7dd4d3a9.js"><link rel="prefetch" href="/assets/js/46.e56eaf37.js"><link rel="prefetch" href="/assets/js/47.da342511.js"><link rel="prefetch" href="/assets/js/48.cbbd8d3b.js"><link rel="prefetch" href="/assets/js/49.a6f47f54.js"><link rel="prefetch" href="/assets/js/5.a0604c3a.js"><link rel="prefetch" href="/assets/js/50.25f66b1a.js"><link rel="prefetch" href="/assets/js/51.5b1e7130.js"><link rel="prefetch" href="/assets/js/52.8dc14867.js"><link rel="prefetch" href="/assets/js/53.ab17ba56.js"><link rel="prefetch" href="/assets/js/54.9f389172.js"><link rel="prefetch" href="/assets/js/55.3f8402a0.js"><link rel="prefetch" href="/assets/js/56.7812e04a.js"><link rel="prefetch" href="/assets/js/57.27701d0e.js"><link rel="prefetch" href="/assets/js/58.f5c0333b.js"><link rel="prefetch" href="/assets/js/59.cdc96c9a.js"><link rel="prefetch" href="/assets/js/6.8b274b9b.js"><link rel="prefetch" href="/assets/js/60.c5097746.js"><link rel="prefetch" href="/assets/js/61.48120d1e.js"><link rel="prefetch" href="/assets/js/62.34a79b85.js"><link rel="prefetch" href="/assets/js/63.76e16f99.js"><link rel="prefetch" href="/assets/js/64.eb0d9986.js"><link rel="prefetch" href="/assets/js/65.9c78d511.js"><link rel="prefetch" href="/assets/js/66.30999ac4.js"><link rel="prefetch" href="/assets/js/67.6ab1b635.js"><link rel="prefetch" href="/assets/js/68.61e8f33c.js"><link rel="prefetch" href="/assets/js/69.66370aaa.js"><link rel="prefetch" href="/assets/js/7.85ae2b1a.js"><link rel="prefetch" href="/assets/js/70.f7989438.js"><link rel="prefetch" href="/assets/js/71.baafbd60.js"><link rel="prefetch" href="/assets/js/72.bba0f5bb.js"><link rel="prefetch" href="/assets/js/73.3389addf.js"><link rel="prefetch" href="/assets/js/74.8fe6f59c.js"><link rel="prefetch" href="/assets/js/75.51406c33.js"><link rel="prefetch" href="/assets/js/76.f75b5b3a.js"><link rel="prefetch" href="/assets/js/77.9cd29229.js"><link rel="prefetch" href="/assets/js/78.4e0d9a39.js"><link rel="prefetch" href="/assets/js/79.0f33cc9e.js"><link rel="prefetch" href="/assets/js/8.e834b23c.js"><link rel="prefetch" href="/assets/js/80.8955c71d.js"><link rel="prefetch" href="/assets/js/81.6f0964b7.js"><link rel="prefetch" href="/assets/js/82.561a0d53.js"><link rel="prefetch" href="/assets/js/83.db9b1b06.js"><link rel="prefetch" href="/assets/js/84.c39eefdf.js"><link rel="prefetch" href="/assets/js/85.91935454.js"><link rel="prefetch" href="/assets/js/86.0e009b4c.js"><link rel="prefetch" href="/assets/js/87.a8104f2e.js"><link rel="prefetch" href="/assets/js/88.662c011b.js"><link rel="prefetch" href="/assets/js/89.68b846e5.js"><link rel="prefetch" href="/assets/js/9.bd0189b0.js"><link rel="prefetch" href="/assets/js/90.c7548022.js"><link rel="prefetch" href="/assets/js/91.27eac16f.js"><link rel="prefetch" href="/assets/js/92.ec96e4fa.js"><link rel="prefetch" href="/assets/js/93.d0a00c29.js"><link rel="prefetch" href="/assets/js/94.8ab72aa4.js"><link rel="prefetch" href="/assets/js/95.7a1438cd.js"><link rel="prefetch" href="/assets/js/96.6113cb02.js"><link rel="prefetch" href="/assets/js/97.829375f3.js"><link rel="prefetch" href="/assets/js/98.4d3ac07f.js"><link rel="prefetch" href="/assets/js/99.2b55bde8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e7427e48.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Manual de usuario</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/analysis/" class="nav-link">
  Crono Analysis
</a></div><div class="nav-item"><a href="/metadata/" class="nav-link">
  Crono Metadata
</a></div><div class="nav-item"><a href="/etl/" class="nav-link">
  Crono ETL
</a></div><div class="nav-item"><a href="/sql/" class="nav-link router-link-active">
  Crono SQL
</a></div><div class="nav-item"><a href="https://businessintelligence.es" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Empresa 🏛️
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/analysis/" class="nav-link">
  Crono Analysis
</a></div><div class="nav-item"><a href="/metadata/" class="nav-link">
  Crono Metadata
</a></div><div class="nav-item"><a href="/etl/" class="nav-link">
  Crono ETL
</a></div><div class="nav-item"><a href="/sql/" class="nav-link router-link-active">
  Crono SQL
</a></div><div class="nav-item"><a href="https://businessintelligence.es" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Empresa 🏛️
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/intro.html" class="sidebar-link">Introducción</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/sql/language/" class="sidebar-heading clickable router-link-active open"><span>Lenguaje Crono SQL</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/language/select.html" class="sidebar-link">Sentencia SELECT ❤️</a></li><li><a href="/sql/language/insert.html" class="sidebar-link">Sentencia INSERT</a></li><li><a href="/sql/language/update.html" class="sidebar-link">Sentencia UPDATE</a></li><li><a href="/sql/language/merge.html" aria-current="page" class="active sidebar-link">Sentencias MERGE ❤️</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-clone" class="sidebar-link">MERGE CLONE</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-upsert" class="sidebar-link">MERGE UPSERT</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-all" class="sidebar-link">MERGE ALL</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-update" class="sidebar-link">MERGE UPDATE</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-soft-delete" class="sidebar-link">MERGE SOFT DELETE</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-incremental" class="sidebar-link">MERGE INCREMENTAL</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#merge-history" class="sidebar-link">MERGE HISTORY</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#sintaxis-merge-estandar" class="sidebar-link">Sintaxis MERGE estándar</a></li><li class="sidebar-sub-header"><a href="/sql/language/merge.html#resumen" class="sidebar-link">Resumen</a></li></ul></li><li><a href="/sql/language/delete..html" class="sidebar-link">Sentencia DELETE</a></li><li><a href="/sql/language/truncate.html" class="sidebar-link">Sentencia TRUNCATE</a></li><li><a href="/sql/language/ddl.html" class="sidebar-link">Sentencias DDL</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/sql/reference/" class="sidebar-heading clickable"><span>Referencia del lenguaje</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/reference/main-sentences.html" class="sidebar-link">Sentencias principales</a></li><li><a href="/sql/reference/keywords.html" class="sidebar-link">Palabras reservadas</a></li><li><a href="/sql/reference/check-snowflake.html" class="sidebar-link">CHECK SNOWFLAKE</a></li><li><a href="/sql/reference/file.html" class="sidebar-link">FILE</a></li><li><a href="/sql/reference/integers-between.html" class="sidebar-link">INTEGERS BETWEEN</a></li><li><a href="/sql/reference/join.html" class="sidebar-link">JOIN</a></li><li><a href="/sql/reference/materialize.html" class="sidebar-link">MATERIALIZE</a></li><li><a href="/sql/reference/over.html" class="sidebar-link">OVER 🚧</a></li><li><a href="/sql/reference/rows-columns.html" class="sidebar-link">ROWS y COLUMNS</a></li><li><a href="/sql/reference/select-anidado.html" class="sidebar-link">SELECTs anidados</a></li><li><a href="/sql/reference/time-table.html" class="sidebar-link">Tabla de tiempo</a></li><li><a href="/sql/reference/unpivot.html" class="sidebar-link">UNPIVOT</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/sql/functions/" class="sidebar-heading clickable"><span>Funciones</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-aggregation-functions.html" class="sidebar-heading clickable open"><span>Funciones de agregación</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/avg.html" class="sidebar-link">avg</a></li><li><a href="/sql/functions/checksum_agg.html" class="sidebar-link">checksum_agg</a></li><li><a href="/sql/functions/concat_ws.html" class="sidebar-link">concat_ws</a></li><li><a href="/sql/functions/count.html" class="sidebar-link">count</a></li><li><a href="/sql/functions/count_big.html" class="sidebar-link">count_big</a></li><li><a href="/sql/functions/countdistinct.html" class="sidebar-link">countdistinct ❇️</a></li><li><a href="/sql/functions/cume_dist.html" class="sidebar-link">cume_dist</a></li><li><a href="/sql/functions/decile.html" class="sidebar-link">decile ❇️</a></li><li><a href="/sql/functions/dense_rank.html" class="sidebar-link">dense_rank</a></li><li><a href="/sql/functions/first_value.html" class="sidebar-link">first_value</a></li><li><a href="/sql/functions/lag.html" class="sidebar-link">lag</a></li><li><a href="/sql/functions/last_value.html" class="sidebar-link">last_value</a></li><li><a href="/sql/functions/lead.html" class="sidebar-link">lead</a></li><li><a href="/sql/functions/least.html" class="sidebar-link">least</a></li><li><a href="/sql/functions/max.html" class="sidebar-link">max</a></li><li><a href="/sql/functions/min.html" class="sidebar-link">min</a></li><li><a href="/sql/functions/next_value.html" class="sidebar-link">next_value ❇️</a></li><li><a href="/sql/functions/ntile.html" class="sidebar-link">ntile</a></li><li><a href="/sql/functions/pct.html" class="sidebar-link">pct ❇️</a></li><li><a href="/sql/functions/pctrank.html" class="sidebar-link">pctrank ❇️</a></li><li><a href="/sql/functions/pctvariance.html" class="sidebar-link">pctvariance ❇️ 🚧</a></li><li><a href="/sql/functions/percent_rank.html" class="sidebar-link">percent_rank</a></li><li><a href="/sql/functions/percentile.html" class="sidebar-link">percentile ❇️</a></li><li><a href="/sql/functions/percentile_cont.html" class="sidebar-link">percentile_cont</a></li><li><a href="/sql/functions/percentile_disc.html" class="sidebar-link">percentile_disc</a></li><li><a href="/sql/functions/previous_value.html" class="sidebar-link">previous_value ❇️</a></li><li><a href="/sql/functions/quantile.html" class="sidebar-link">quantile ❇️</a></li><li><a href="/sql/functions/quartile.html" class="sidebar-link">quartile ❇️</a></li><li><a href="/sql/functions/rank.html" class="sidebar-link">rank</a></li><li><a href="/sql/functions/row_number.html" class="sidebar-link">row_number</a></li><li><a href="/sql/functions/runningpct.html" class="sidebar-link">runningpct ❇️</a></li><li><a href="/sql/functions/runningsum.html" class="sidebar-link">runningsum ❇️</a></li><li><a href="/sql/functions/single.html" class="sidebar-link">single ❇️ 🚧</a></li><li><a href="/sql/functions/stdev.html" class="sidebar-link">stdev</a></li><li><a href="/sql/functions/stdevp.html" class="sidebar-link">stdevp</a></li><li><a href="/sql/functions/string_agg.html" class="sidebar-link">string_agg</a></li><li><a href="/sql/functions/sum.html" class="sidebar-link">sum ❤️</a></li><li><a href="/sql/functions/total.html" class="sidebar-link">total ❇️</a></li><li><a href="/sql/functions/var.html" class="sidebar-link">var</a></li><li><a href="/sql/functions/varp.html" class="sidebar-link">varp</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-conversion-functions.html" class="sidebar-heading clickable"><span>Funciones de conversión y lógicas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/bighex.html" class="sidebar-link">bighex ❇️ 🚧</a></li><li><a href="/sql/functions/bigint.html" class="sidebar-link">bigint ❇️ 🚧</a></li><li><a href="/sql/functions/binary_checksum.html" class="sidebar-link">binary_checksum</a></li><li><a href="/sql/functions/bit.html" class="sidebar-link">bit ❇️ 🚧</a></li><li><a href="/sql/functions/cast.html" class="sidebar-link">cast</a></li><li><a href="/sql/functions/char.html" class="sidebar-link">char</a></li><li><a href="/sql/functions/choose.html" class="sidebar-link">choose</a></li><li><a href="/sql/functions/coalesce.html" class="sidebar-link">coalesce ❇️ ❤️</a></li><li><a href="/sql/functions/convert.html" class="sidebar-link">convert 🚧</a></li><li><a href="/sql/functions/date.html" class="sidebar-link">date ❇️</a></li><li><a href="/sql/functions/datetime.html" class="sidebar-link">datetime ❇️ 🚧</a></li><li><a href="/sql/functions/datetime2.html" class="sidebar-link">datetime2 ❇️ 🚧</a></li><li><a href="/sql/functions/elementat.html" class="sidebar-link">elementat ❇️</a></li><li><a href="/sql/functions/emptyifnull.html" class="sidebar-link">emptyifnull ❇️</a></li><li><a href="/sql/functions/float.html" class="sidebar-link">float ❇️ 🚧</a></li><li><a href="/sql/functions/hex.html" class="sidebar-link">hex ❇️ 🚧</a></li><li><a href="/sql/functions/iif.html" class="sidebar-link">iif</a></li><li><a href="/sql/functions/indexof.html" class="sidebar-link">indexof ❇️</a></li><li><a href="/sql/functions/int.html" class="sidebar-link">int ❇️ 🚧</a></li><li><a href="/sql/functions/isnull.html" class="sidebar-link">isnull</a></li><li><a href="/sql/functions/isnumeric.html" class="sidebar-link">isnumeric</a></li><li><a href="/sql/functions/nullif.html" class="sidebar-link">nullif 🚧</a></li><li><a href="/sql/functions/nullifempty.html" class="sidebar-link">nullifempty ❇️</a></li><li><a href="/sql/functions/nullifzero.html" class="sidebar-link">nullifzero ❇️</a></li><li><a href="/sql/functions/parse.html" class="sidebar-link">parse</a></li><li><a href="/sql/functions/smallhex.html" class="sidebar-link">smallhex ❇️ 🚧</a></li><li><a href="/sql/functions/smallint.html" class="sidebar-link">smallint ❇️ 🚧</a></li><li><a href="/sql/functions/switch.html" class="sidebar-link">switch ❇️</a></li><li><a href="/sql/functions/time.html" class="sidebar-link">time ❇️ 🚧</a></li><li><a href="/sql/functions/tinyhex.html" class="sidebar-link">tinyhex ❇️ 🚧</a></li><li><a href="/sql/functions/tinyint.html" class="sidebar-link">tinyint ❇️ 🚧</a></li><li><a href="/sql/functions/try_cast.html" class="sidebar-link">try_cast</a></li><li><a href="/sql/functions/try_convert.html" class="sidebar-link">try_convert</a></li><li><a href="/sql/functions/try_parse.html" class="sidebar-link">try_parse</a></li><li><a href="/sql/functions/uchar.html" class="sidebar-link">uchar ❇️</a></li><li><a href="/sql/functions/unicodechar.html" class="sidebar-link">unicodechar ❇️ 🚧</a></li><li><a href="/sql/functions/zeroifnull.html" class="sidebar-link">zeroifnull ❇️</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-date-functions.html" class="sidebar-heading clickable"><span>Funciones de fecha</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/current_date.html" class="sidebar-link">current_date ❇️ 🚧</a></li><li><a href="/sql/functions/current_time.html" class="sidebar-link">current_time ❇️ 🚧</a></li><li><a href="/sql/functions/current_timestamp.html" class="sidebar-link">current_timestamp ❇️</a></li><li><a href="/sql/functions/current_timezone.html" class="sidebar-link">current_timezone</a></li><li><a href="/sql/functions/current_timezone_id.html" class="sidebar-link">current_timezone_id</a></li><li><a href="/sql/functions/dateadd.html" class="sidebar-link">dateadd</a></li><li><a href="/sql/functions/datediff.html" class="sidebar-link">datediff ❇️</a></li><li><a href="/sql/functions/datediff_big.html" class="sidebar-link">datediff_big</a></li><li><a href="/sql/functions/datefromparts.html" class="sidebar-link">datefromparts</a></li><li><a href="/sql/functions/datename.html" class="sidebar-link">datename ❇️</a></li><li><a href="/sql/functions/datepart.html" class="sidebar-link">datepart ❇️</a></li><li><a href="/sql/functions/datetime2fromparts.html" class="sidebar-link">datetime2fromparts</a></li><li><a href="/sql/functions/datetimefromparts.html" class="sidebar-link">datetimefromparts</a></li><li><a href="/sql/functions/datetimeoffsetfromparts.html" class="sidebar-link">datetimeoffsetfromparts</a></li><li><a href="/sql/functions/datetrunc.html" class="sidebar-link">datetrunc</a></li><li><a href="/sql/functions/day.html" class="sidebar-link">day</a></li><li><a href="/sql/functions/eomonth.html" class="sidebar-link">eomonth</a></li><li><a href="/sql/functions/getdate.html" class="sidebar-link">getdate ❤️</a></li><li><a href="/sql/functions/getenddate.html" class="sidebar-link">getenddate ❇️ 🚧</a></li><li><a href="/sql/functions/getenddatetime.html" class="sidebar-link">getenddatetime ❇️ 🚧</a></li><li><a href="/sql/functions/getutcdate.html" class="sidebar-link">getutcdate</a></li><li><a href="/sql/functions/hour.html" class="sidebar-link">hour ❇️</a></li><li><a href="/sql/functions/isdate.html" class="sidebar-link">isdate</a></li><li><a href="/sql/functions/isoweek.html" class="sidebar-link">isoweek ❇️</a></li><li><a href="/sql/functions/isoweekcode.html" class="sidebar-link">isoweekcode ❇️</a></li><li><a href="/sql/functions/isoweekshortcode.html" class="sidebar-link">isoweekshortcode ❇️</a></li><li><a href="/sql/functions/isoweekyear.html" class="sidebar-link">isoweekyear ❇️</a></li><li><a href="/sql/functions/localdate.html" class="sidebar-link">localdate ❇️</a></li><li><a href="/sql/functions/localdatetimeoffset.html" class="sidebar-link">localdatetimeoffset ❇️</a></li><li><a href="/sql/functions/month.html" class="sidebar-link">month</a></li><li><a href="/sql/functions/smalldatetimefromparts.html" class="sidebar-link">smalldatetimefromparts</a></li><li><a href="/sql/functions/switchoffset.html" class="sidebar-link">switchoffset</a></li><li><a href="/sql/functions/sysdatetime.html" class="sidebar-link">sysdatetime</a></li><li><a href="/sql/functions/sysdatetimeoffset.html" class="sidebar-link">sysdatetimeoffset</a></li><li><a href="/sql/functions/sysutcdatetime.html" class="sidebar-link">sysutcdatetime</a></li><li><a href="/sql/functions/timefromparts.html" class="sidebar-link">timefromparts</a></li><li><a href="/sql/functions/todatetimeoffset.html" class="sidebar-link">todatetimeoffset</a></li><li><a href="/sql/functions/today.html" class="sidebar-link">today ❇️</a></li><li><a href="/sql/functions/tomorrow.html" class="sidebar-link">tomorrow ❇️</a></li><li><a href="/sql/functions/year.html" class="sidebar-link">year</a></li><li><a href="/sql/functions/yyyymmdd.html" class="sidebar-link">yyyymmdd ❇️ 🚧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-text-functions.html" class="sidebar-heading clickable"><span>Funciones de texto</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/abc.html" class="sidebar-link">abc ❇️</a></li><li><a href="/sql/functions/ascii.html" class="sidebar-link">ascii</a></li><li><a href="/sql/functions/charindex.html" class="sidebar-link">charindex</a></li><li><a href="/sql/functions/compress.html" class="sidebar-link">compress</a></li><li><a href="/sql/functions/concat.html" class="sidebar-link">concat ❤️</a></li><li><a href="/sql/functions/decompress.html" class="sidebar-link">decompress</a></li><li><a href="/sql/functions/difference.html" class="sidebar-link">difference</a></li><li><a href="/sql/functions/format.html" class="sidebar-link">format</a></li><li><a href="/sql/functions/hashbytes.html" class="sidebar-link">hashbytes</a></li><li><a href="/sql/functions/left.html" class="sidebar-link">left ❇️ ❤️</a></li><li><a href="/sql/functions/len.html" class="sidebar-link">len</a></li><li><a href="/sql/functions/lower.html" class="sidebar-link">lower</a></li><li><a href="/sql/functions/ltrim.html" class="sidebar-link">ltrim</a></li><li><a href="/sql/functions/nchar.html" class="sidebar-link">nchar</a></li><li><a href="/sql/functions/patindex.html" class="sidebar-link">patindex</a></li><li><a href="/sql/functions/quotename.html" class="sidebar-link">quotename</a></li><li><a href="/sql/functions/replace.html" class="sidebar-link">replace ❤️</a></li><li><a href="/sql/functions/replicate.html" class="sidebar-link">replicate</a></li><li><a href="/sql/functions/reverse.html" class="sidebar-link">reverse</a></li><li><a href="/sql/functions/right.html" class="sidebar-link">right ❇️</a></li><li><a href="/sql/functions/rtrim.html" class="sidebar-link">rtrim</a></li><li><a href="/sql/functions/soundex.html" class="sidebar-link">soundex</a></li><li><a href="/sql/functions/str.html" class="sidebar-link">str</a></li><li><a href="/sql/functions/string_split.html" class="sidebar-link">string_split</a></li><li><a href="/sql/functions/stuff.html" class="sidebar-link">stuff</a></li><li><a href="/sql/functions/substring.html" class="sidebar-link">substring</a></li><li><a href="/sql/functions/trim.html" class="sidebar-link">trim ❇️</a></li><li><a href="/sql/functions/unicode.html" class="sidebar-link">unicode</a></li><li><a href="/sql/functions/upper.html" class="sidebar-link">upper</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-math-functions.html" class="sidebar-heading clickable"><span>Funciones matemáticas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/abs.html" class="sidebar-link">abs ❤️</a></li><li><a href="/sql/functions/acos.html" class="sidebar-link">acos</a></li><li><a href="/sql/functions/addition.html" class="sidebar-link">addition ❇️ ❤️</a></li><li><a href="/sql/functions/asin.html" class="sidebar-link">asin</a></li><li><a href="/sql/functions/atan.html" class="sidebar-link">atan</a></li><li><a href="/sql/functions/atn2.html" class="sidebar-link">atn2</a></li><li><a href="/sql/functions/ceiling.html" class="sidebar-link">ceiling</a></li><li><a href="/sql/functions/cos.html" class="sidebar-link">cos</a></li><li><a href="/sql/functions/cot.html" class="sidebar-link">cot</a></li><li><a href="/sql/functions/degrees.html" class="sidebar-link">degrees</a></li><li><a href="/sql/functions/divide.html" class="sidebar-link">divide ❇️</a></li><li><a href="/sql/functions/exp.html" class="sidebar-link">exp</a></li><li><a href="/sql/functions/floor.html" class="sidebar-link">floor</a></li><li><a href="/sql/functions/generate_series.html" class="sidebar-link">generate_series</a></li><li><a href="/sql/functions/greatest.html" class="sidebar-link">greatest</a></li><li><a href="/sql/functions/log.html" class="sidebar-link">log</a></li><li><a href="/sql/functions/log10.html" class="sidebar-link">log10</a></li><li><a href="/sql/functions/margin.html" class="sidebar-link">margin ❇️</a></li><li><a href="/sql/functions/markup.html" class="sidebar-link">markup ❇️</a></li><li><a href="/sql/functions/maximum.html" class="sidebar-link">maximum ❇️</a></li><li><a href="/sql/functions/minimum.html" class="sidebar-link">minimum ❇️</a></li><li><a href="/sql/functions/mod.html" class="sidebar-link">mod ❇️</a></li><li><a href="/sql/functions/pi.html" class="sidebar-link">pi</a></li><li><a href="/sql/functions/power.html" class="sidebar-link">power</a></li><li><a href="/sql/functions/radians.html" class="sidebar-link">radians</a></li><li><a href="/sql/functions/rand.html" class="sidebar-link">rand</a></li><li><a href="/sql/functions/round.html" class="sidebar-link">round ❇️ ❤️</a></li><li><a href="/sql/functions/sign.html" class="sidebar-link">sign</a></li><li><a href="/sql/functions/sin.html" class="sidebar-link">sin</a></li><li><a href="/sql/functions/space.html" class="sidebar-link">space</a></li><li><a href="/sql/functions/sqrt.html" class="sidebar-link">sqrt</a></li><li><a href="/sql/functions/square.html" class="sidebar-link">square</a></li><li><a href="/sql/functions/substraction.html" class="sidebar-link">substraction ❇️</a></li><li><a href="/sql/functions/tan.html" class="sidebar-link">tan</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/functions/index-system-functions.html" class="sidebar-heading clickable"><span>Funciones de sistema</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/functions/checksum.html" class="sidebar-link">checksum</a></li><li><a href="/sql/functions/col_length.html" class="sidebar-link">col_length</a></li><li><a href="/sql/functions/col_name.html" class="sidebar-link">col_name</a></li><li><a href="/sql/functions/collationproperty.html" class="sidebar-link">collationproperty</a></li><li><a href="/sql/functions/columnproperty.html" class="sidebar-link">columnproperty</a></li><li><a href="/sql/functions/columns_updated.html" class="sidebar-link">columns_updated</a></li><li><a href="/sql/functions/current_transaction_id.html" class="sidebar-link">current_transaction_id</a></li><li><a href="/sql/functions/current_user.html" class="sidebar-link">current_user ❇️</a></li><li><a href="/sql/functions/currentusername.html" class="sidebar-link">currentusername ❇️ ❤️</a></li><li><a href="/sql/functions/cursor_status.html" class="sidebar-link">cursor_status</a></li><li><a href="/sql/functions/database_principal_id.html" class="sidebar-link">database_principal_id</a></li><li><a href="/sql/functions/databaseproperty.html" class="sidebar-link">databaseproperty 🚧</a></li><li><a href="/sql/functions/databasepropertyex.html" class="sidebar-link">databasepropertyex</a></li><li><a href="/sql/functions/datalength.html" class="sidebar-link">datalength</a></li><li><a href="/sql/functions/date_bucket.html" class="sidebar-link">date_bucket</a></li><li><a href="/sql/functions/db_id.html" class="sidebar-link">db_id</a></li><li><a href="/sql/functions/db_name.html" class="sidebar-link">db_name</a></li><li><a href="/sql/functions/error_line.html" class="sidebar-link">error_line</a></li><li><a href="/sql/functions/error_message.html" class="sidebar-link">error_message</a></li><li><a href="/sql/functions/error_number.html" class="sidebar-link">error_number</a></li><li><a href="/sql/functions/error_procedure.html" class="sidebar-link">error_procedure</a></li><li><a href="/sql/functions/error_severity.html" class="sidebar-link">error_severity</a></li><li><a href="/sql/functions/error_state.html" class="sidebar-link">error_state</a></li><li><a href="/sql/functions/file_name.html" class="sidebar-link">file_name</a></li><li><a href="/sql/functions/filegroup_id.html" class="sidebar-link">filegroup_id</a></li><li><a href="/sql/functions/filegroup_name.html" class="sidebar-link">filegroup_name</a></li><li><a href="/sql/functions/filegroupproperty.html" class="sidebar-link">filegroupproperty</a></li><li><a href="/sql/functions/fileproperty.html" class="sidebar-link">fileproperty</a></li><li><a href="/sql/functions/formatmessage.html" class="sidebar-link">formatmessage</a></li><li><a href="/sql/functions/fulltextcatalogproperty.html" class="sidebar-link">fulltextcatalogproperty</a></li><li><a href="/sql/functions/fulltextserviceproperty.html" class="sidebar-link">fulltextserviceproperty</a></li><li><a href="/sql/functions/getansinull.html" class="sidebar-link">getansinull</a></li><li><a href="/sql/functions/has_dbaccess.html" class="sidebar-link">has_dbaccess</a></li><li><a href="/sql/functions/host_id.html" class="sidebar-link">host_id</a></li><li><a href="/sql/functions/host_name.html" class="sidebar-link">host_name</a></li><li><a href="/sql/functions/ident_current.html" class="sidebar-link">ident_current</a></li><li><a href="/sql/functions/ident_incr.html" class="sidebar-link">ident_incr</a></li><li><a href="/sql/functions/ident_seed.html" class="sidebar-link">ident_seed</a></li><li><a href="/sql/functions/identity.html" class="sidebar-link">identity</a></li><li><a href="/sql/functions/index_col.html" class="sidebar-link">index_col</a></li><li><a href="/sql/functions/indexproperty.html" class="sidebar-link">indexproperty</a></li><li><a href="/sql/functions/is_member.html" class="sidebar-link">is_member</a></li><li><a href="/sql/functions/is_srvrolemember.html" class="sidebar-link">is_srvrolemember</a></li><li><a href="/sql/functions/ismemberof.html" class="sidebar-link">ismemberof ❇️</a></li><li><a href="/sql/functions/memberof.html" class="sidebar-link">memberof ❇️</a></li><li><a href="/sql/functions/newid.html" class="sidebar-link">newid</a></li><li><a href="/sql/functions/newsequentialid.html" class="sidebar-link">newsequentialid</a></li><li><a href="/sql/functions/object_id.html" class="sidebar-link">object_id</a></li><li><a href="/sql/functions/object_name.html" class="sidebar-link">object_name</a></li><li><a href="/sql/functions/objectproperty.html" class="sidebar-link">objectproperty</a></li><li><a href="/sql/functions/opendatasource.html" class="sidebar-link">opendatasource</a></li><li><a href="/sql/functions/openquery.html" class="sidebar-link">openquery</a></li><li><a href="/sql/functions/openrowset.html" class="sidebar-link">openrowset</a></li><li><a href="/sql/functions/parsename.html" class="sidebar-link">parsename</a></li><li><a href="/sql/functions/permissions.html" class="sidebar-link">permissions</a></li><li><a href="/sql/functions/rowcount_big.html" class="sidebar-link">rowcount_big</a></li><li><a href="/sql/functions/schema_id.html" class="sidebar-link">schema_id</a></li><li><a href="/sql/functions/schema_name.html" class="sidebar-link">schema_name</a></li><li><a href="/sql/functions/scope_identity.html" class="sidebar-link">scope_identity</a></li><li><a href="/sql/functions/security.html" class="sidebar-link">security</a></li><li><a href="/sql/functions/serverproperty.html" class="sidebar-link">serverproperty</a></li><li><a href="/sql/functions/session_user.html" class="sidebar-link">session_user ❇️</a></li><li><a href="/sql/functions/sessionproperty.html" class="sidebar-link">sessionproperty</a></li><li><a href="/sql/functions/sql_variant_property.html" class="sidebar-link">sql_variant_property</a></li><li><a href="/sql/functions/stats_date.html" class="sidebar-link">stats_date</a></li><li><a href="/sql/functions/suser_id.html" class="sidebar-link">suser_id</a></li><li><a href="/sql/functions/suser_name.html" class="sidebar-link">suser_name</a></li><li><a href="/sql/functions/suser_sid.html" class="sidebar-link">suser_sid</a></li><li><a href="/sql/functions/suser_sname.html" class="sidebar-link">suser_sname</a></li><li><a href="/sql/functions/system_user.html" class="sidebar-link">system_user ❇️</a></li><li><a href="/sql/functions/type_name.html" class="sidebar-link">type_name</a></li><li><a href="/sql/functions/typeproperty.html" class="sidebar-link">typeproperty</a></li><li><a href="/sql/functions/user_name.html" class="sidebar-link">user_name</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/sql/views/" class="sidebar-heading clickable"><span>Vistas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/views/index-db-views.html" class="sidebar-heading clickable open"><span>Vistas de base de datos</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/views/cronoansicolumns.html" class="sidebar-link">Crono$AnsiColumns</a></li><li><a href="/sql/views/cronoansiforeignkeys.html" class="sidebar-link">Crono$AnsiForeignKeys</a></li><li><a href="/sql/views/cronocolumnextendedproperties.html" class="sidebar-link">Crono$ColumnExtendedProperties</a></li><li><a href="/sql/views/cronocolumns.html" class="sidebar-link">Crono$Columns ❤️</a></li><li><a href="/sql/views/cronoconstraints.html" class="sidebar-link">Crono$Constraints</a></li><li><a href="/sql/views/cronoconstraintscolumns.html" class="sidebar-link">Crono$ConstraintsColumns</a></li><li><a href="/sql/views/cronodatabaseextendedproperties.html" class="sidebar-link">Crono$DatabaseExtendedProperties</a></li><li><a href="/sql/views/cronodatabases.html" class="sidebar-link">Crono$Databases</a></li><li><a href="/sql/views/cronoforeignkeys.html" class="sidebar-link">Crono$ForeignKeys</a></li><li><a href="/sql/views/cronoindexcolumns.html" class="sidebar-link">Crono$IndexColumns</a></li><li><a href="/sql/views/cronoindexes.html" class="sidebar-link">Crono$Indexes</a></li><li><a href="/sql/views/cronoparameters.html" class="sidebar-link">Crono$Parameters</a></li><li><a href="/sql/views/cronoprocedureextendedproperties.html" class="sidebar-link">Crono$ProcedureExtendedProperties</a></li><li><a href="/sql/views/cronoprocedures.html" class="sidebar-link">Crono$Procedures ❤️</a></li><li><a href="/sql/views/cronoroutines.html" class="sidebar-link">Crono$Routines</a></li><li><a href="/sql/views/cronoschemas.html" class="sidebar-link">Crono$Schemas</a></li><li><a href="/sql/views/cronotableextendedproperties.html" class="sidebar-link">Crono$TableExtendedProperties</a></li><li><a href="/sql/views/cronotables.html" class="sidebar-link">Crono$Tables ❤️</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/views/index-metadata-views.html" class="sidebar-heading clickable"><span>Vistas de metadata de Crono</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/views/cronocronofunctions.html" class="sidebar-link">Crono$CronoFunctions</a></li><li><a href="/sql/views/cronocronoviews.html" class="sidebar-link">Crono$CronoViews</a></li><li><a href="/sql/views/cronoemojis.html" class="sidebar-link">Crono$Emojis</a></li><li><a href="/sql/views/cronofunctions.html" class="sidebar-link">Crono$Functions</a></li><li><a href="/sql/views/cronokeywords.html" class="sidebar-link">Crono$Keywords</a></li><li><a href="/sql/views/cronosqlfunctions.html" class="sidebar-link">Crono$SqlFunctions</a></li><li><a href="/sql/views/cronounicodechars.html" class="sidebar-link">Crono$UnicodeChars</a></li><li><a href="/sql/views/cronounicodetable.html" class="sidebar-link">Crono$UnicodeTable</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/views/index-time-views.html" class="sidebar-heading clickable"><span>Vistas de tiempo</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/views/cronodates.html" class="sidebar-link">Crono$Dates ❤️</a></li><li><a href="/sql/views/cronomonths.html" class="sidebar-link">Crono$Months</a></li><li><a href="/sql/views/cronoweeks.html" class="sidebar-link">Crono$Weeks</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/views/index-ad-views.html" class="sidebar-heading clickable"><span>Vistas del Directorio Activo</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/views/cronoactivedirectorygroups.html" class="sidebar-link">Crono$ActiveDirectoryGroups</a></li><li><a href="/sql/views/cronoactivedirectorygroupsof.html" class="sidebar-link">Crono$ActiveDirectoryGroupsOf</a></li><li><a href="/sql/views/cronoactivedirectorymygroups.html" class="sidebar-link">Crono$ActiveDirectoryMyGroups</a></li><li><a href="/sql/views/cronoactivedirectoryusers.html" class="sidebar-link">Crono$ActiveDirectoryUsers</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-2"><a href="/sql/views/index-misc-views.html" class="sidebar-heading clickable"><span>Vistas misceláneas</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/sql/views/cronocountries.html" class="sidebar-link">Crono$Countries</a></li><li><a href="/sql/views/cronospanishcities.html" class="sidebar-link">Crono$SpanishCities</a></li><li><a href="/sql/views/cronospanishprovinces.html" class="sidebar-link">Crono$SpanishProvinces</a></li><li><a href="/sql/views/cronospanishregions.html" class="sidebar-link">Crono$SpanishRegions</a></li><li><a href="/sql/views/cronotimezones.html" class="sidebar-link">Crono$TimeZones</a></li></ul></section></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sentencias-merge-❤️"><a href="#sentencias-merge-❤️" class="header-anchor">#</a> Sentencias MERGE ❤️</h1> <p>La sentencia <strong>MERGE</strong> carga los datos en una <strong>tabla destino</strong> a partir del resultado de una <strong>consulta de origen</strong>.</p> <p>Existen las siguientes variantes <strong>MERGE</strong>. Cada una de ella responde a una estrategia de carga en proyectos ETL/DWH:</p> <table><thead><tr><th>Nombre</th> <th>Descripción</th></tr></thead> <tbody><tr><td><strong>MERGE CLONE</strong></td> <td>Añade los registros nuevos, actualiza los existentes que hayan cambiado, y elimina los registros ausentes en el origen</td></tr> <tr><td><strong>MERGE UPSERT</strong> (o <strong>MERGE</strong>)</td> <td>Añade los registros nuevos y actualiza los existentes (que hayan cambiado)</td></tr> <tr><td><strong>MERGE ALL</strong></td> <td>Añade los registros nuevos y actualiza los existentes (hayan cambiado o no)</td></tr> <tr><td><strong>MERGE UPDATE</strong></td> <td>Actualiza los existentes que hayan cambiado, sin añadir ninguno ni eliminar ninguno. Es igual que el <strong>UPDATE</strong> de <strong>Crono SQL</strong></td></tr> <tr><td><strong>MERGE SOFT DELETE</strong></td> <td>Añade los registros nuevos, actualiza los existentes que hayan cambiado, e informa la fecha de eliminación de los registros ausentes en el origen</td></tr> <tr><td><strong>MERGE INCREMENTAL</strong></td> <td>Añade los registros nuevos, sin actualizar ni eliminar ninguno. Es igual que el <strong>INSERT</strong> de <strong>Crono SQL</strong></td></tr> <tr><td><strong>MERGE HISTORY</strong></td> <td>Añade los registros nuevos manteniendo la historia de los cambios en los campos &quot;fecha inicio vigencia&quot; y &quot;fecha fin vigencia&quot;. Es una carga SCD2</td></tr></tbody></table> <p>Estas 7 estrategias, o un subconjunto de ellas, suelen ser suficientes para implementar cualquier proyecto ETL/DWH. Habitualmente, las estrategias <strong>MERGE CLONE</strong> y <strong>MERGE UPSERT</strong> se utilizan para cargar tablas de dimensión, y <strong>MERGE CLONE</strong> y <strong>MERGE INCREMENTAL</strong> se utilizan para cargar tablas de hechos. De todos modos, eso dependerá de las necesidades de cada tabla y de cada proyecto.</p> <p>Todas las instrucciones <strong>MERGE</strong> crean la tabla de destino si es necesario, así como la clave de negocio, y los campos de auditoria.</p> <p>La sintaxis es muy sencilla. Simplemente hay que indicar la <strong>consulta de origen</strong> (especificando la &quot;clave de actualización&quot;) y la <strong>tabla de destino</strong>. A continuación se incluyen ejemplos de uso de estas 7 estrategias.</p> <h2 id="merge-clone"><a href="#merge-clone" class="header-anchor">#</a> MERGE CLONE</h2> <p>La instrucción <strong>MERGE CLONE</strong> realiza una actualización completa de la tabla. Es decir: Añade, elimina o actualiza todos los registros de la tabla destino para que coincidan exactamente con el contenido de la consulta de origen. Convierte literalmente la tabla destino en un clon de la consulta de origen.</p> <p>Se utiliza en tablas de hechos pequeñas o en aquellas tablas de dimensión en que sabemos que no se eliminan registros, o que es aceptable que se eliminen registros obsoletos. Se trata de la estrategia más común en cualquier proyecto DWH (en muchas ocasiones <strong>MERGE CLONE</strong> es la única instrucción necesaria).</p> <p>La sintaxis es idéntica a la utilizada en la sintaxis <strong>Crono SQL</strong> de <strong>UPDATE</strong> o <strong>INSERT</strong>, tal y como muestra este ejemplo.</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> CLONE dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">select</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>Es importante observar que el campo <em>ProductId</em> está precedido por el <strong>carácter numeral #</strong>. Esta marca sirve para identificar la <strong>clave de actualización</strong>. Habitualmente coincide con la clave de negocio (código único que identifica a cada registro).</p> <p>El código generado realiza un <strong>MERGE</strong> e informa convenientemente los campos <em>FechaAlta</em>, <em>FechaBaja</em> y <em>FechaModificacion</em>.</p> <p>Si la tabla no existe en el momento de ejecución, la creará añadiéndole el campo <em>ProductSid</em> como una clave subrogada (un entero autonumérico <strong>INDENTITY</strong>). También creará un <strong>UNIQUE CONSTRAINT</strong> para el campo <em>ProductId</em> (que debe ser único).</p> <p>Si en el futuro se modifica la consulta, añadiendo más campos a la dimensión, <strong>Crono SQL</strong> generará también el código necesario para crear esos nuevos campos en la tabla.</p> <p>En este ejemplo, después de los <strong>JOIN</strong>, se ha incluido la clausula <strong>CHECK SNOWFLAKE</strong>. Por lo tanto, antes de realizar la carga, <strong>Crono SQL</strong> verificará que la consulta de origen no pierda ni duplique registros de <em>staging.Products</em>.</p> <p>El código generado es óptimo y presenta un gran rendimiento, por lo que esta estrategia es adecuada también en tablas de hechos no excesivamente grandes:</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> CLONE dwh<span class="token punctuation">.</span>FactSalesOrderDetails<span class="token punctuation">(</span>SalesOrderDetailSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span>
	SalesOrderDetail<span class="token punctuation">.</span>SalesOrderDetailID <span class="token comment">#SalesOrderDetailID,</span>
	DimProducts<span class="token punctuation">.</span>ProductSid						ProductSid	NONUNIQUE <span class="token keyword">REFERENCES</span> dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">,</span>
	FactSalesOrderHeader<span class="token punctuation">.</span>SalesOrderSid			SalesOrderSid NONUNIQUE	<span class="token keyword">REFERENCES</span> dwh<span class="token punctuation">.</span>FactSalesOrderHeader<span class="token punctuation">,</span>
	SalesOrderDetail<span class="token punctuation">.</span>CarrierTrackingNumber<span class="token punctuation">,</span>
	SalesOrderDetail<span class="token punctuation">.</span>OrderQty<span class="token punctuation">,</span>
	SalesOrderDetail<span class="token punctuation">.</span>UnitPrice<span class="token punctuation">,</span>
	SalesOrderDetail<span class="token punctuation">.</span>UnitPriceDiscount<span class="token punctuation">,</span>
	SalesOrderDetail<span class="token punctuation">.</span>LineTotal<span class="token punctuation">,</span>
	SpecialOffer<span class="token punctuation">.</span>Description SpecialOffer<span class="token punctuation">,</span>
	SpecialOffer<span class="token punctuation">.</span><span class="token keyword">Type</span>			SpecialOfferType<span class="token punctuation">,</span>
	SpecialOffer<span class="token punctuation">.</span>Category		SpecialOfferCategory<span class="token punctuation">,</span>
<span class="token keyword">from</span> @<span class="token variable">@erp.SalesOrderDetail</span> SalesOrderDetail
<span class="token keyword">inner</span> <span class="token keyword">join</span> @<span class="token variable">@erp.SalesOrderHeader</span> <span class="token keyword">using</span> <span class="token punctuation">(</span>SalesOrderID<span class="token punctuation">)</span>  
<span class="token keyword">inner</span> <span class="token keyword">join</span> @<span class="token variable">@erp.SpecialOffer</span> <span class="token keyword">using</span> <span class="token punctuation">(</span>SpecialOfferID<span class="token punctuation">)</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> @<span class="token variable">@erp.Product</span> <span class="token keyword">using</span> <span class="token punctuation">(</span>ProductID<span class="token punctuation">)</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> dwh<span class="token punctuation">.</span>DimProducts <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductID<span class="token punctuation">)</span>
<span class="token keyword">inner</span> <span class="token keyword">join</span> dwh<span class="token punctuation">.</span>FactSalesOrderHeader <span class="token keyword">using</span> SalesOrderHeader<span class="token punctuation">(</span>SalesOrderID<span class="token punctuation">)</span>
<span class="token keyword">check</span> snowflake
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>Incluso si la tabla de origen tuviese unos pocos millones de registros, la carga anterior se ejecutaría rápidamente (con el Hardware adecuado).</p> <p>En cambio, si la tabla de origen tuviese varias decenas de millones de registros (o más) recomendaríamos utilizar alguna estrategia de carga incremental.</p> <h2 id="merge-upsert"><a href="#merge-upsert" class="header-anchor">#</a> MERGE UPSERT</h2> <p>La instrucción <strong>MERGE UPSERT</strong> es una carga de <strong>dimensión lentamente cambiante tipo 1</strong>. Esta estrategia de carga actualiza los registros que se han modificado desde la última carga y añade los nuevos, pero nunca elimina los registros existentes.</p> <p>Se utiliza habitualmente para cargar tablas de dimensión, ya que se requiere mantener los registros antiguos para respetar la integridad (no queremos borrar un producto o un cliente que tal vez tiene ventas u otras transacciones asociadas).</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> UPSERT dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
<span class="token keyword">CHECK</span> SNOWFLAKE
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>Es importante observar que el campo <em>ProductId</em> está precedido por el <strong>carácter numeral #</strong>. Esta marca es importante ya que sirve para identificar la <strong>clave de actualización</strong>. Habitualmente coincide con la clave de negocio (código único que identifica a cada registro)</p> <p>El código generado realiza un <strong>MERGE</strong> para actualizar o insertar cada registro. También informa convenientemente los campos <em>FechaAlta</em>, <em>FechaBaja</em> y <em>FechaModificacion</em>.</p> <p>Al igual que en todas las instrucciones <strong>MERGE</strong> de <strong>Crono SQL</strong>, se creará la tabla si no existe. También se añadirán los campos, índices o restricciones que falten.</p> <p>Las estrategía <strong>UPSERT</strong> es la predeterminada del <strong>MERGE</strong>. Por este motivo, el siguiente ejemplo es exactamente equivalente a ejecutar <strong>MERGE UPSERT</strong>.</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">select</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
<span class="token keyword">CHECK</span> SNOWFLAKE
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <h2 id="merge-all"><a href="#merge-all" class="header-anchor">#</a> MERGE ALL</h2> <p>La instrucción <strong>MERGE ALL</strong> se comparta igual que <strong>MERGE UPSERT</strong>. La única diferencia es que <strong>MERGE ALL</strong> actualiza todos los registros (hayan cambiado o no). Esta diferencia raramente aportará ningún beneficio (¡Al contrario... penalizará el rendimiento por actualizar registros que no lo necesitan!), por lo que se prefiere usar <strong>MERGE UPSERT</strong>.</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> <span class="token keyword">ALL</span> dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
<span class="token keyword">CHECK</span> SNOWFLAKE
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <h2 id="merge-update"><a href="#merge-update" class="header-anchor">#</a> MERGE UPDATE</h2> <p>La instrucción <strong>MERGE UPDATE</strong> actualiza los registros que aparecen en la consulta de origen y ya existen en la tabla de destino. No elimina ni inserta ningún registro.</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> <span class="token keyword">UPDATE</span> dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
<span class="token keyword">CHECK</span> SNOWFLAKE
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>La instrucción <strong>MERGE UPDATE</strong> es equivalente a la instrucción <strong>UPDATE</strong> de <strong>Crono SQL</strong></p> <h2 id="merge-soft-delete"><a href="#merge-soft-delete" class="header-anchor">#</a> MERGE SOFT DELETE</h2> <p>La instrucción <strong>MERGE SOFT DELETE</strong> actualiza los registros que se han modificado desde la última carga, añade los nuevos y establece la <em>fecha de eliminación</em> de los registros eliminados en el origen. Es decir, en lugar de eliminar físicamente los registros, hace un borrado lógico.</p> <p>Se utiliza habitualmente para cargar tablas de dimensión, ya que se requiere mantener los registros antiguos para respetar la integridad (no queremos borrar un producto o un cliente que tal vez tiene ventas u otras transacciones asociadas).</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> SOFT <span class="token keyword">DELETE</span> dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span>
<span class="token keyword">select</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <h2 id="merge-incremental"><a href="#merge-incremental" class="header-anchor">#</a> MERGE INCREMENTAL</h2> <p>La instrucción <strong>MERGE INCREMENTAL</strong> realiza una carga incremental de la tabla.</p> <p>Las cargas incrementales son adecuadas para tablas de hechos con muchos millones de registros.</p> <p>Frecuentemente las cargas incrementales son problemáticas:</p> <ul><li>La mayor dificultad de las cargas incrementales es determinar los registros que se deben añadir. Es necesario identificar en origen los registros nuevos desde la última carga (mediante un <em>timestamp</em>, habitualmente).</li> <li>Otro riesgo de las cargas incrementales es que modificaciones extraordinarias en el origen pueden no reflejarse en en DWH (no siempre los responsables del ERP puede asegurar que ningún proceso o incidencia pueda modificar algún día registros antiguos).</li></ul> <p>Por estos motivos, si el tiempo de ejecución es aceptable, es preferible utilizar <strong>MERGE CLONE</strong> siempre que sea posible, aunque el tiempo de ejecución sea algo mayor.</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> INCREMENTAL dwh<span class="token punctuation">.</span>FactSalesOrderHeader<span class="token punctuation">(</span>SalesOrderSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderId<span class="token punctuation">,</span>
  Customer<span class="token punctuation">.</span>CustomerId<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>OrderDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> OrderDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderNumber<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>DueDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> DueDate<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>ShipDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> ShipDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>OnlineOrderFlag<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>PurchaseOrderNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>AccountNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>Freight<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>CreditCardApprovalCode<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SubTotal Amount<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>TaxAmt
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>SalesOrderHeader
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>customer <span class="token keyword">using</span> SalesOrderHeader<span class="token punctuation">(</span>customerId<span class="token punctuation">)</span>
<span class="token keyword">where</span> cast<span class="token punctuation">(</span>OrderDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span><span class="token operator">=</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>La anterior sentencia cargará las ventas del día anterior (y solo las del día anterior). Evidentemente, esta estrategia es débil y propensa a errores. Dejará de cargar registros si algún día no se ejecuta la carga, o podría duplicarlos si se ejecutase dos veces un mismo día. También fallaría si algún proceso del ERP se retrasase varios días en insertar los datos de alguna tienda...</p> <p>La siguiente estrategia resuelve parcialmente el problema:</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> INCREMENTAL dwh<span class="token punctuation">.</span>FactSalesOrderHeader<span class="token punctuation">(</span>SalesOrderSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderId <span class="token comment">#SalesOrderId,</span>
  Customer<span class="token punctuation">.</span>CustomerId<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>OrderDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> OrderDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderNumber<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>DueDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> DueDate<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>ShipDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> ShipDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>OnlineOrderFlag<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>PurchaseOrderNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>AccountNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>Freight<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>CreditCardApprovalCode<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SubTotal Amount<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>TaxAmt
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>SalesOrderHeader
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>customer <span class="token keyword">using</span> SalesOrderHeader<span class="token punctuation">(</span>customerId<span class="token punctuation">)</span>
<span class="token keyword">where</span> OrderDate<span class="token operator">&lt;=</span>getdate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">30</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>En el caso anterior se cargarían las ventas de los últimos 30 días que no se hayan cargado previamente. La marca <strong>#</strong> especifica la <strong>clave de inserción</strong>, es decir, que no se insertarán <em>SalesOrderId</em> que ya existan en la tabla de destino. Esta estrategia es recomendable si tenemos la seguridad de que:</p> <ol><li>Ninguna venta tarda más de 30 días en cargarse en el sistema</li> <li>Los registros de venta una vez insertados en el origen no cambian nunca.</li></ol> <p>Otra opción sería añadir incrementalmente aquellos registros añadidos en el ERP desde la última carga (requiere un campo &quot;<em>timestamp</em>&quot; en el origen).</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> <span class="token variable">@last</span> <span class="token keyword">timestamp</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">max</span><span class="token punctuation">(</span>InsertTimestamp<span class="token punctuation">)</span> <span class="token keyword">from</span> FactSalesOrderHeader<span class="token punctuation">)</span>
<span class="token keyword">MERGE</span> INCREMENTAL dwh<span class="token punctuation">.</span>FactSalesOrderHeader<span class="token punctuation">(</span>SalesOrderSid<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> 
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderId<span class="token punctuation">,</span>
  Customer<span class="token punctuation">.</span>CustomerId<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>OrderDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> OrderDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SalesOrderNumber<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>DueDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> DueDate<span class="token punctuation">,</span>
  cast<span class="token punctuation">(</span>SalesOrderHeader<span class="token punctuation">.</span>ShipDate <span class="token keyword">as</span> <span class="token keyword">date</span><span class="token punctuation">)</span> ShipDate<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>OnlineOrderFlag<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>PurchaseOrderNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>AccountNumber<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>Freight<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>CreditCardApprovalCode<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>SubTotal Amount<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>TaxAmt<span class="token punctuation">,</span>
  SalesOrderHeader<span class="token punctuation">.</span>InsertTimestamp
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>SalesOrderHeader
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>customer <span class="token keyword">using</span> SalesOrderHeader<span class="token punctuation">(</span>customerId<span class="token punctuation">)</span>
<span class="token keyword">where</span> SalesOrderHeader<span class="token punctuation">.</span>InsertTimestamp<span class="token operator">&gt;</span><span class="token variable">@last</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>Observad como en este caso se ha declarado la variable <em>@last</em> con la fecha del último registro insertado.</p> <p>En resumen, las cargas incrementales son adecuadas para aquellas situaciones en las que el origen tiene muchos millones de registros y solo se producen inserciones.</p> <p>La instrucción <strong>MERGE INCREMENTAL</strong> es equivalente a la instrucción <strong>INSERT</strong> de <strong>Crono SQL</strong>.</p> <h2 id="merge-history"><a href="#merge-history" class="header-anchor">#</a> MERGE HISTORY</h2> <p>La instrucción <strong>MERGE HISTORY</strong> es una carga de <strong>dimensión lentamente cambiante tipo 2</strong>. Esta estrategia guarda la historia completa de los cambios utilizando los campos de <em>fecha de inicio</em> y <em>fecha de fin vigencia</em>. De esta manera, es posible conocer el contenido que tenía cualquier registro en una fecha dada. En esta estrategia de carga no se eliminan ni actualizan registros nunca. La instrucción <strong>MERGE HISTORY</strong> únicamente añade los registros que han cambiado desde la última carga (y actualiza los campos de vigencia que correspondan).</p> <p>Se utiliza para cargar tablas de dimensión en las que es necesario guardar la historia de cambios.</p> <p>La sintaxis es la misma que en los casos anteriores (y la mismas que la del <strong>INSERT</strong> o <strong>UPDATE</strong>....).Únicamente es necesario cambiar el nombre de la estrategia a utilizar: <strong>MERGE HISTORY</strong></p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">MERGE</span> HISTORY dwh<span class="token punctuation">.</span>DimProducts<span class="token punctuation">(</span>ProductSid<span class="token punctuation">)</span> 
<span class="token keyword">select</span> 
  <span class="token comment">#ProductID,</span>
  Product<span class="token punctuation">.</span>Name Product<span class="token punctuation">,</span>
  ProductCategory<span class="token punctuation">.</span>name ProductCategory<span class="token punctuation">,</span>
  ProductSubCategory<span class="token punctuation">.</span>name ProductSubCategory<span class="token punctuation">,</span>
  ProductNumber<span class="token punctuation">,</span>
  ProductModel<span class="token punctuation">.</span>name ProductModel<span class="token punctuation">,</span>
  Color<span class="token punctuation">,</span>
  StandardCost<span class="token punctuation">,</span>
  ListPrice<span class="token punctuation">,</span>
  Size<span class="token punctuation">,</span>
  SizeUnitMeasureCode<span class="token punctuation">,</span>
  Weight
<span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductSubcategoryID<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">using</span> ProductSubCategory<span class="token punctuation">(</span>ProductCategoryId<span class="token punctuation">)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">using</span> Product<span class="token punctuation">(</span>ProductModelID<span class="token punctuation">)</span>
<span class="token keyword">CHECK</span> SNOWFLAKE
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>El código generado realiza un <strong>MERGE</strong> para actualizar las fechas de fin vigencia, y un <strong>INSERT</strong> para añadir los registros que han cambiado y los nuevos registros.</p> <p>También en este caso, <strong>Crono SQL</strong> genera automáticamente al código repetitivo:</p> <ul><li>Creación de la tabla y los campos necesarios</li> <li>Creación de la clave subrogada</li> <li>Creación y carga de los campos de auditoria</li> <li>Comprobación de la corrección de los <strong>JOIN</strong> (ya que aparece la cláusula <strong>CHECK SNOWFLAKE</strong>).</li></ul> <div class="custom-block tip"><p class="custom-block-title">RECUERDA</p> <p>Es interesante observar que la elección entre <strong>MERGE CLONE</strong>, <strong>MERGE UPSERT</strong> y <strong>MERGE HISTORY</strong> depende únicamente de las necesidades de negocio. Con <strong>Crono SQL</strong> cuesta exactamente lo mismo programar una carga SCD de tipo 1 o de tipo 2.</p></div> <h2 id="sintaxis-merge-estandar"><a href="#sintaxis-merge-estandar" class="header-anchor">#</a> Sintaxis MERGE estándar</h2> <p>El lenguaje <strong>Crono SQL</strong> admite también la sintaxis SQL estándar de la sentencia <strong>MERGE</strong>:</p> <div class="mt-1 mb-2 row"><div class="col-lg-12"><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">WITH</span>
query <span class="token keyword">AS</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>
    ProductID <span class="token keyword">AS</span> ProductId<span class="token punctuation">,</span>
    Product<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> Product<span class="token punctuation">,</span>
    ProductCategory<span class="token punctuation">.</span>name <span class="token keyword">AS</span> ProductCategory<span class="token punctuation">,</span>
    ProductSubCategory<span class="token punctuation">.</span>name <span class="token keyword">AS</span> ProductSubCategory<span class="token punctuation">,</span>
    ProductNumber<span class="token punctuation">,</span>
    ProductModel<span class="token punctuation">.</span>name <span class="token keyword">AS</span> ProductModel<span class="token punctuation">,</span>
    Product<span class="token punctuation">.</span>Color <span class="token keyword">AS</span> Color<span class="token punctuation">,</span>
    Product<span class="token punctuation">.</span>StandardCost <span class="token keyword">AS</span> ProductCost
  <span class="token keyword">FROM</span> staging<span class="token punctuation">.</span>Product
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductSubCategory <span class="token keyword">ON</span> <span class="token punctuation">(</span>Product<span class="token punctuation">.</span>ProductSubcategoryID<span class="token operator">=</span>ProductSubCategory<span class="token punctuation">.</span>ProductSubcategoryID<span class="token punctuation">)</span>
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductCategory <span class="token keyword">ON</span> <span class="token punctuation">(</span>ProductSubCategory<span class="token punctuation">.</span>ProductCategoryId<span class="token operator">=</span>ProductCategory<span class="token punctuation">.</span>ProductCategoryId<span class="token punctuation">)</span>
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> staging<span class="token punctuation">.</span>ProductModel <span class="token keyword">ON</span> <span class="token punctuation">(</span>Product<span class="token punctuation">.</span>ProductModelID<span class="token operator">=</span>ProductModel<span class="token punctuation">.</span>ProductModelID<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">MERGE</span> dwh<span class="token punctuation">.</span>DimProducts <span class="token keyword">AS</span> DimProducts
<span class="token keyword">USING</span> query <span class="token keyword">ON</span> query<span class="token punctuation">.</span>ProductId<span class="token operator">=</span>DimProducts<span class="token punctuation">.</span>ProductId
<span class="token keyword">WHEN</span> <span class="token keyword">MATCHED</span> <span class="token keyword">THEN</span>
  <span class="token keyword">UPDATE</span> <span class="token keyword">SET</span>
    Product<span class="token operator">=</span>query<span class="token punctuation">.</span>Product<span class="token punctuation">,</span>
    ProductCategory<span class="token operator">=</span>query<span class="token punctuation">.</span>ProductCategory<span class="token punctuation">,</span>
    ProductSubCategory<span class="token operator">=</span>query<span class="token punctuation">.</span>ProductSubCategory<span class="token punctuation">,</span>
    ProductNumber<span class="token operator">=</span>query<span class="token punctuation">.</span>ProductNumber<span class="token punctuation">,</span>
    ProductModel<span class="token operator">=</span>query<span class="token punctuation">.</span>ProductModel<span class="token punctuation">,</span>
    Color<span class="token operator">=</span>query<span class="token punctuation">.</span>Color<span class="token punctuation">,</span>
    ProductCost<span class="token operator">=</span>query<span class="token punctuation">.</span>ProductCost
<span class="token keyword">WHEN</span> <span class="token operator">NOT</span> <span class="token keyword">MATCHED</span> <span class="token keyword">THEN</span> 
  <span class="token keyword">INSERT</span> <span class="token punctuation">(</span>
    ProductId<span class="token punctuation">,</span>
    Product<span class="token punctuation">,</span>
    ProductCategory<span class="token punctuation">,</span>
    ProductSubCategory<span class="token punctuation">,</span>
    ProductNumber<span class="token punctuation">,</span>
    ProductModel<span class="token punctuation">,</span>
    Color<span class="token punctuation">,</span>ProductCost<span class="token punctuation">)</span>
  <span class="token keyword">VALUES</span> <span class="token punctuation">(</span>
    query<span class="token punctuation">.</span>ProductId<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>Product<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>ProductCategory<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>ProductSubCategory<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>ProductNumber<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>ProductModel<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>Color<span class="token punctuation">,</span>
    query<span class="token punctuation">.</span>ProductCost<span class="token punctuation">)</span>
</code></pre></div> <button type="button" class="btn float-right btn btn-secondary btn-sm" style="background-color:#3eaf7c;">Ver SQL compilado</button> <!----></div></div> <p>La sentencia <strong>MERGE</strong>, en función de una serie de condiciones definidas, ejecutará un <strong>UPDATE</strong> de los registros que hayan cambiado y un <strong>INSERT</strong> de los registros de la consulta origen que no existan en la tabla destino. Por este motivo se le conoce como <strong>UPSERT</strong> (<strong>UPDATE</strong>+<strong>INSERT</strong>).</p> <p>Debería ser la &quot;sentencia estrella&quot; de cualquier proyecto ETL/DWH, porque en estos proyectos lo que en definitiva se necesita es replicar los datos del origen en la tabla destino (¡exactamente lo que promete hacer el <strong>MERGE</strong>!). Lamentablemente, la sintaxis ISO es compleja, está llena de repeticiones, y es muy difícil escribir correctamente. Por este motivo, muchos desarrolladores la desconocen, o no la usan, y buscan métodos alternativos para realizar el trabajo (con mucho peor rendimiento, habitualmente).</p> <p>En un proyecto <strong>Crono SQL</strong> nunca es necesario utilizar la sintaxis estándar, y se proponer utilizar siempre la sintaxis compacta de <strong>MERGE CLONE</strong>, <strong>MERGE UPSERT</strong>, etc.</p> <h2 id="resumen"><a href="#resumen" class="header-anchor">#</a> Resumen</h2> <p>La sentencia <strong>MERGE</strong> permite cargar una tabla aplicando alguna de las estrategias de carga disponibles. Las más habituales son:</p> <ul><li><strong>MERGE CLONE</strong>: Actualización completa</li> <li><strong>MERGE UPSERT</strong> (o simplemente <strong>MERGE</strong>): Dimensión lentamente cambiante tipo 1</li> <li><strong>MERGE INCREMENTAL</strong>: Carga incremental</li> <li><strong>MERGE HISTORY</strong>: Dimensión lentamente cambiante tipo 2</li></ul> <p>El uso de un conjunto cerrado y reducido de estrategias aporta muchos beneficios:</p> <ul><li>El uso de estrategias asegura un código homogéneo y fácil de mantener, y permite que el desarrollador se centre en aquellas actividades que realmente aportan valor.</li> <li>Una característica importante del lenguaje es que al programador le costará exactamente lo mismo aplicar cualquier estrategia de carga. Es decir, la decisión de utilizar una u otra <u>no</u> se verá influenciada por la dificultad de programarlo, por lo que la decisión se tomará en función de las necesidades del negocio.</li> <li>Además, el código SQL generado está altamente optimizado para obtener siempre el máximo rendimiento. <strong>Crono SQL</strong> no actua como una caja negra sino que delega totalmente el trabajo a quien mejor sabe hacerlo (el motor de la base de datos).</li> <li><strong>Crono SQL</strong> genera automáticamente todo el código repetitivo. No hemos de preocuparnos ni de crear la tabla. Todas las tablas tendrán campos de auditoría correctamente informados. Ni siquiera hemos de escribir el farragoso código necesario para ejecutar un <strong>MERGE</strong>, un <strong>UPDATE</strong>, o un <strong>INSERT</strong>.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sql/language/update.html" class="prev">
        Sentencia UPDATE
      </a></span> <span class="next"><a href="/sql/language/delete..html">
        Sentencia DELETE
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.10bbc7f8.js" defer></script><script src="/assets/js/2.b4361566.js" defer></script><script src="/assets/js/322.21684d99.js" defer></script>
  </body>
</html>
