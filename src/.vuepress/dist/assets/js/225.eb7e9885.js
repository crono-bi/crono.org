(window.webpackJsonp=window.webpackJsonp||[]).push([[225],{535:function(a,e,n){"use strict";n.r(e);var t=n(11),s=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"pctrank-❇️"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pctrank-❇️"}},[a._v("#")]),a._v(" pctrank ❇️")]),a._v(" "),e("p",[a._v("La función "),e("code",[a._v("pctrank")]),a._v(" es una función de ventana que devuelve el ranking de cada fila normalizado entre 0 y 1.")]),a._v(" "),e("p",[a._v("Requiere la cláusula ORDER BY en la partición OVER.")]),a._v(" "),e("p",[a._v("Se puede usar tanto la sintaxis "),e("code",[a._v("OVER")]),a._v(" del SQL estándar como la sintaxis compacta propia de Crono.")]),a._v(" "),e("h2",{attrs:{id:"ejemplo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ejemplo"}},[a._v("#")]),a._v(" Ejemplo")]),a._v(" "),e("p",[a._v("La siguiente consulta devuelve el 40% de las tiendas con mayor venta.")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("select \n  lb_tiendas.nombre tienda,\n  sum(unidades) ventas,\n  pctrank(order by ventas desc) rank\nfrom dbo.lb_ventas\ninner join lb_tiendas using id_tienda\ngroup by all\nqualify rank<0.4\n")])])]),e("p",[a._v("La consulta SQL generada es:")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("SELECT *\nFROM (\n    SELECT\n      lb_tiendas.nombre AS tienda,\n      sum(unidades) AS ventas,\n      1.0*rank() OVER (ORDER BY sum(unidades) DESC)/count(*) OVER () AS rank\n    FROM dbo.lb_ventas\n    INNER JOIN lb_tiendas ON (lb_ventas.id_tienda=lb_tiendas.id_tienda)\n    GROUP BY lb_tiendas.nombre\n  ) a\nWHERE rank<0.4\n")])])]),e("h2",{attrs:{id:"comentarios"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#comentarios"}},[a._v("#")]),a._v(" Comentarios")]),a._v(" "),e("p",[a._v("Esta función es similar a "),e("code",[a._v("rank")]),a._v(" y "),e("code",[a._v("percentile")]),a._v(". La función "),e("code",[a._v("rank")]),a._v(" devuelve la posición ordinal de cada registro, "),e("code",[a._v("percentile")]),a._v(" la normaliza entre 0 y 100, y "),e("code",[a._v("pctrank")]),a._v("la normaliza entre 0 y 1.")])])}),[],!1,null,null,null);e.default=s.exports}}]);