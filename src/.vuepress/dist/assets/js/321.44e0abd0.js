(window.webpackJsonp=window.webpackJsonp||[]).push([[321],{623:function(t,s,a){"use strict";a.r(s);var n=a(11),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"sentencia-insert"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sentencia-insert"}},[t._v("#")]),t._v(" Sentencia INSERT")]),t._v(" "),s("p",[s("strong",[t._v("Crono SQL")]),t._v(" soporta la sintaxis est√°ndar de la sentencia "),s("strong",[t._v("INSERT")]),t._v(":")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  StandardCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  WeightUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-1",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("StandardCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WeightUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" StandardCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Sin embargo, especialmente cuando la tabla tiene muchas columnas, esta sintaxis es repetitiva e inc√≥moda de mantener.  Por ello, "),s("strong",[t._v("Crono SQL")]),t._v(" prescinde de la cl√°usula "),s("strong",[t._v("VALUES")]),t._v(" y asume que el nombre de los campos coincide con el "),s("em",[t._v("alias")]),t._v(" de las columnas de la consulta de origen:")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-2",modifiers:{"modal-2":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-2",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" WeightUnitMeasureCode\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WeightUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Por supuesto, para definir el  origen de datos del "),s("strong",[t._v("INSERT")]),t._v(" se pueden utilizar "),s("a",{attrs:{href:"#sentencia-select"}},[t._v("todas las caracter√≠sticas de la sentencia "),s("strong",[t._v("SELECT")])]),t._v(" de "),s("strong",[t._v("Crono SQL")]),t._v(". En la siguiente consulta, por ejemplo, se verifica que las relaciones sean correctas antes de realizar la inserci√≥n. Es decir, si las relaciones pierden o duplican registros,  no se ejecutar√° el "),s("strong",[t._v("INSERT")]),t._v(".")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" SNOWFLAKE\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-3",modifiers:{"modal-3":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-3",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" THROW "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Las relaciones de esta consulta pierden o duplican registros de Product.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" WeightUnitMeasureCode\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WeightUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Tambi√©n se puede utilizar, por ejemplo, la sentencia "),s("strong",[t._v("COMBINE")]),t._v(" o la funcionalidad de "),s("strong",[t._v("MATERIALIZE")]),t._v(". En la siguiente consulta se verificar√° que todas las relaciones sean correctas, se crear√°n entonces las tablas temporales con la informaci√≥n de "),s("em",[t._v("ventas")]),t._v(" y "),s("em",[t._v("compras")]),t._v(", y finalmente se unir√°n mediante un "),s("strong",[t._v("FULL JOIN")]),t._v(" en un √∫nico resultado a insertar.")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("VentasVsCompras\nCOMBINE "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber\n  MATERIALIZE sales "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n      Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PurchaseOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LineTotal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Purchases\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderDetail\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("inner")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductId\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" SNOWFLAKE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  MATERIALIZE purchases "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n      Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LineTotal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Sales\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderDetail\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("inner")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductId\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHECK")]),t._v(" SNOWFLAKE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-4",modifiers:{"modal-4":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-4",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Materialized query: sales")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PurchaseOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LineTotal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Purchases\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sales__14C85")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderDetail\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PurchaseOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Materialized query: purchases")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LineTotal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Sales\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#purchases__9D591")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderDetail\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderDetail\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PurchaseOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CASE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHEN")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("THEN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" THROW "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Las relaciones de esta consulta pierden o duplican registros de PurchaseOrderDetail.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderDetail\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CASE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHEN")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("THEN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderDetail"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" THROW "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50001")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Las relaciones de esta consulta pierden o duplican registros de SalesOrderDetail.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("coalesce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sales"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("coalesce")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sales"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    sales"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Purchases "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sales "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Sales\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#sales__14C85 sales")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#purchases__9D591 purchases ON (sales.Product=purchases.Product AND sales.ProductNumber=purchases.ProductNumber)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("VentasVsCompras"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Sales"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Purchases"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Sales\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v('Una necesidad habitual en ETL/DWH es insertar √∫nicamente los registros que no existan en la tabla destino. Para ello, es necesario especificar la "clave de inserci√≥n". La clave de inserci√≥n se define mediante el '),s("em",[t._v("car√°cter #")]),t._v(" delante del  "),s("em",[t._v("alias")]),t._v(" de cada campo. Como veremos a lo largo de este tutorial, las claves de todas las estrategias de carga se definen con el car√°cter "),s("strong",[t._v("#")]),t._v(".")]),t._v(" "),s("p",[t._v("La siguiente consulta inserta los productos que no existan a√∫n en la tabla "),s("em",[t._v("dwh.DimProducts")])]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#ProductID,")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-5",modifiers:{"modal-5":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-5",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" WeightUnitMeasureCode\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategoryId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WeightUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ListPrice"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SizeUnitMeasureCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Weight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WeightUnitMeasureCode\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Es es posible realizar una recarga completa mediante la sentencia "),s("strong",[t._v("DELETE AND INSERT")]),t._v(". Esta sentencia elimina el contenido de la tabla y la recarga con los datos de la consulta de origen.")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost ProductCost\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-6",modifiers:{"modal-6":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-6",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCost\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCost\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Tambi√©n es posible realizar un "),s("strong",[t._v("TRUNCATE AND INSERT")])]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRUNCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" \n  ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost ProductCost\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-7",modifiers:{"modal-7":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-7",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRUNCATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StandardCost "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ProductCost\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubcategoryID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModelID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DimProducts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProductCost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductSubCategory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductModel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Color"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductCost\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("La opci√≥n "),s("strong",[t._v("PARTITION")]),t._v(" permite recargar solo una parte de la tabla. Por ejemplo, es habitual cargar solo los movimientos del mes en curso (si sabemos que los dem√°s no han sido modificados). La siguiente sentencia recarga las ventas de los √∫ltimos 30 d√≠as:")]),t._v(" "),s("div",{staticClass:"mt-1 mb-2 row"},[s("div",{staticClass:"col-lg-12"},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FactSalesOrderHeader "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("OrderDate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v("getdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" \n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Customer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" OrderDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DueDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" DueDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  cast"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ShipDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OnlineOrderFlag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AccountNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreditCardApprovalCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SubTotal Amount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TaxAmt\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderHeader\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("customerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" OrderDate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v("getdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n")])])]),t._v(" "),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-8",modifiers:{"modal-8":!0}}],staticClass:"float-right btn",staticStyle:{"background-color":"#3eaf7c"},attrs:{size:"sm"}},[t._v("Ver SQL compilado")]),t._v(" "),s("b-modal",{attrs:{id:"modal-8",size:"lg",title:"Ver SQL compilado","hide-footer":!0}},[s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FactSalesOrderHeader\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v("\n  FactSalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v("getdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v("\nquery "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderId "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SalesOrderId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    Customer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" CustomerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    CAST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" OrderDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderNumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" SalesOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    CAST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DueDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" DueDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    CAST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ShipDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OnlineOrderFlag "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" OnlineOrderFlag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderNumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" PurchaseOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AccountNumber "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" AccountNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Freight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreditCardApprovalCode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" CreditCardApprovalCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SubTotal "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" Amount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TaxAmt "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" TaxAmt\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderHeader\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INNER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" staging"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customer "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customerId"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("customer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" CAST"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v("getdate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" dwh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FactSalesOrderHeader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SalesOrderId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CustomerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("OrderDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("SalesOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("DueDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ShipDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("OnlineOrderFlag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("PurchaseOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("AccountNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Freight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CreditCardApprovalCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Amount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TaxAmt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SalesOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DueDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OnlineOrderFlag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PurchaseOrderNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AccountNumber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CreditCardApprovalCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Amount"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TaxAmt\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])])],1)]),t._v(" "),s("p",[t._v("Con el tipo de estrategias descritas en este apartado es posible conseguir que cada tabla se cargue desde una √∫nica sentencia, centralizando la l√≥gica de negocio en un √∫nico punto, facilitando el desarrollo, y promocionando el seguimiento de buenas pr√°cticas. Los mismos principios y m√©todos se utilizan en el resto de sentencias DML, como se muestra en los siguientes apartados.")])])}),[],!1,null,null,null);s.default=r.exports}}]);